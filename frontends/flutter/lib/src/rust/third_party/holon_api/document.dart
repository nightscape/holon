// This file is automatically generated, so please do not edit it.
// @generated by `flutter_rust_bridge`@ 2.11.1.

// ignore_for_file: invalid_use_of_internal_member, unused_import, unnecessary_import

import '../../frb_generated.dart';
import '../holon_api.dart';
import 'entity.dart';
import 'package:flutter_rust_bridge/flutter_rust_bridge_for_generated.dart';

// These function are ignored because they are on traits that is not defined in current crate (put an empty `#[frb]` on it to unignore): `clone`, `eq`, `fmt`
// These functions are ignored (category: IgnoreBecauseExplicitAttribute): `get_property`, `parse_document_uri`, `properties_map`, `set_property`, `short_name`
// These functions are ignored (category: IgnoreBecauseType): `from_entity`

/// Generate a document URI from a document ID.
///
/// Format: `holon-doc://{doc_id}`
Future<String> documentUri({required String docId}) =>
    RustLib.instance.api.holonApiDocumentDocumentUri(docId: docId);

/// Check if a string is a document URI.
Future<bool> isDocumentUri({required String s}) =>
    RustLib.instance.api.holonApiDocumentIsDocumentUri(s: s);

/// A document in the hierarchical document tree.
///
/// Documents correspond to files on disk and contain blocks. The document
/// hierarchy mirrors the filesystem structure:
/// - Document "projects" → file `projects.org`, folder `projects/`
/// - Document "projects/todo" → file `projects/todo.org`
///
/// # Path Derivation
/// The filesystem path is derived from the document hierarchy:
/// - `name` provides the filename stem
/// - `parent_id` chain provides the directory path
///
/// # Root Document
/// The root document has:
/// - `id = ROOT_DOC_ID` ("__root_doc__")
/// - `parent_id = NO_PARENT_DOC_ID` ("__no_parent__")
/// - `name = ""` (empty, represents the configured root directory)
/// flutter_rust_bridge:non_opaque
class Document {
  /// Unique identifier (UUID or ULID)
  final String id;

  /// Parent document ID. Root document uses NO_PARENT_DOC_ID.
  final String parentId;

  /// Display name / filename stem (e.g., "todo", "projects")
  /// Used to derive the filesystem path. Must be unique within parent.
  final String name;

  /// Fractional index for ordering within parent (lexicographic sort)
  /// Uses same algorithm as blocks (e.g., "a0", "a1", "a1V")
  final String sortKey;

  /// JSON-serialized metadata (title, todo_keywords, custom properties)
  /// Format: {"title": "My Document", "todo_keywords": "TODO DONE", ...}
  final String properties;

  /// Creation timestamp (Unix milliseconds)
  final PlatformInt64 createdAt;

  /// Last update timestamp (Unix milliseconds)
  final PlatformInt64 updatedAt;

  const Document({
    required this.id,
    required this.parentId,
    required this.name,
    required this.sortKey,
    required this.properties,
    required this.createdAt,
    required this.updatedAt,
  });

  static Future<EntitySchema> entitySchema() =>
      RustLib.instance.api.holonApiDocumentDocumentEntitySchema();

  /// Check if this is the root document.
  Future<bool> isRoot() =>
      RustLib.instance.api.holonApiDocumentDocumentIsRoot(that: this);

  // HINT: Make it `#[frb(sync)]` to let it become the default constructor of Dart class.
  /// Create a new document with the given ID and name under the specified parent.
  static Future<Document> newInstance({
    required String id,
    required String parentId,
    required String name,
  }) => RustLib.instance.api.holonApiDocumentDocumentNew(
    id: id,
    parentId: parentId,
    name: name,
  );

  /// Create the root document.
  static Future<Document> root() =>
      RustLib.instance.api.holonApiDocumentDocumentRoot();

  static Future<Schema> schema() =>
      RustLib.instance.api.holonApiDocumentDocumentSchema();

  Future<DynamicEntity> toEntity() =>
      RustLib.instance.api.holonApiDocumentDocumentToEntity(that: this);

  @override
  int get hashCode =>
      id.hashCode ^
      parentId.hashCode ^
      name.hashCode ^
      sortKey.hashCode ^
      properties.hashCode ^
      createdAt.hashCode ^
      updatedAt.hashCode;

  @override
  bool operator ==(Object other) =>
      identical(this, other) ||
      other is Document &&
          runtimeType == other.runtimeType &&
          id == other.id &&
          parentId == other.parentId &&
          name == other.name &&
          sortKey == other.sortKey &&
          properties == other.properties &&
          createdAt == other.createdAt &&
          updatedAt == other.updatedAt;
}
